<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Harshit Kulkarni - My Approach</title> <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <script src="https://d3js.org/d3.v7.min.js"></script>
    
    <style>
        /* Custom styles */
        body {
            font-family: 'Inter', sans-serif;
            /* Dark blue/black background */
            background-color: #05080f; 
            /* RE-ADDED: Moon-like theme */
            background-image: 
                /* The bright, sharp arc (the "partition") */
                radial-gradient(ellipse 80% 40% at 50% 105%, rgba(230, 230, 255, 0.35) 0%, transparent 70%),
                /* The softer, wider atmospheric glow */
                radial-gradient(ellipse 120% 50% at 50% 107%, rgba(180, 180, 200, 0.15) 0%, transparent 100%);
            background-repeat: no-repeat;
            background-attachment: fixed;
            overflow-x: hidden; /* Prevent horizontal scroll */
        }

        /* --- Sine Wave & Stars Canvas Background --- */
        #background-canvas { /* Renamed canvas ID */
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -10; /* Farthest back layer */
        }
        
        /* --- REMOVED CSS Starry Background --- */
        

        /* Custom glassmorphism-style for cards */
        .glass-card {
            /* --- Made MORE transparent --- */
            background: rgba(17, 24, 39, 0.25); /* Semi-transparent dark bg */
            backdrop-filter: blur(10px);
            border: 1px solid rgba(55, 65, 81, 0.3);
        }

        /* Custom styles for the tabs */
        .tab-button.active {
            color: #3b82f6; /* blue-500 */
            border-color: #3b82f6;
        }

        .tab-button {
            transition: all 0.2s ease-in-out;
        }
        
        /* --- Tab transition styles --- */
        [role="tabpanel"] {
            transition: opacity 300ms ease-in-out;
        }
        [role="tabpanel"].hidden {
            opacity: 0;
            /* We don't use display:none to allow transitions */
        }


        /* --- STYLES FOR KNOWLEDGE GRAPH --- */
        #skill-graph-container {
             /* Back to original height */
            height: 600px;
            position: relative; /* Needed for absolute positioning of button */
        }

        /* Fullscreen styles */
        #skill-graph-container.fullscreen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            z-index: 50; /* Ensure it's on top of other content */
            border-radius: 0;
            padding: 1.5rem; /* Re-add padding */
            height: 100vh; /* Ensure full height in fullscreen */
        }

        #skill-graph {
            width: 100%;
            height: 100%;
            cursor: grab; /* Grab cursor for panning */
        }

        #skill-graph:active {
            cursor: grabbing; /* Grabbing cursor when panning */
        }
        
        /* Removed list view wrapper style */

        /* --- Pulsing Glow --- */
        @keyframes pulse-glow {
            0%, 100% {
                filter: drop-shadow(0 0 3px #fff);
            }
            50% {
                filter: drop-shadow(0 0 10px #fff);
            }
        }

        .skill-graph-links line {
            stroke: #6b7280; /* gray-500 */
            stroke-opacity: 0.4;
            /* --- Transitions --- */
            transition: stroke-opacity 0.2s ease, stroke-width 0.2s ease;
        }

        .skill-graph-nodes circle {
            stroke: #e5e7eb; /* gray-200 */
            stroke-width: 1.5px;
            /* --- NO TRANSITIONS (STUTTER FIX) --- */
            cursor: pointer; /* Change cursor for nodes */
            /* --- Glow Effect --- */
            filter: drop-shadow(0 0 3px rgba(255, 255, 255, 0.7));
        }

        /* --- Pulsing Main Node --- */
        .skill-graph-nodes circle.level-0-node {
            animation: pulse-glow 2.5s infinite ease-in-out;
        }

        .skill-graph-labels text {
            fill: #d1d5db; /* gray-300 */
            font-size: 10px;
            font-weight: 500;
            pointer-events: none; /* Make text non-interactive */
            /* --- NO TRANSITIONS (STUTTER FIX) --- */
            /* --- Glow Effect --- */
            filter: drop-shadow(0 0 3px rgba(255, 255, 255, 0.7));
        }
        
        .skill-graph-labels text.level-0 {
            font-size: 16px;
            font-weight: 700;
            fill: #fff;
            animation: pulse-glow 2.5s infinite ease-in-out;
        }
        .skill-graph-labels text.level-1 {
            font-size: 12px;
            font-weight: 600;
            fill: #f3f4f6; /* gray-100 */
        }

        /* --- Creative Toggle Button Style --- */
        #toggle-skill-view {
            background: linear-gradient(145deg, rgba(55, 65, 81, 0.6), rgba(31, 41, 55, 0.6));
            border: 1px solid rgba(55, 65, 81, 0.4);
            transition: all 0.3s ease;
        }
        #toggle-skill-view:hover {
             background: linear-gradient(145deg, rgba(75, 85, 99, 0.7), rgba(55, 65, 81, 0.7));
             transform: translateY(-2px);
             box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
        }
    </style>
</head>
<body class="text-gray-300 antialiased">

    <canvas id="background-canvas"></canvas> <div class="relative z-10">

        <section id="introduction" class="max-w-4xl mx-auto px-6 py-16 md:py-24">
            <h2 class="text-3xl md:text-4xl font-bold text-white mb-8 text-center">
                Introduction:
            </h2>
            <p class="text-lg text-gray-400 leading-relaxed text-center">
                This document outlines my proposal for the Data & AI case study, for which I am applying for the Data Science Lead role. My vision for this position aligns with the described focus on ownership and guiding the technical aspect of the data science function. This proposal addresses how I would approach the key strategic initiatives and responsibilities outlined, particularly focusing on the four key questions provided.
            </p>
        </section>

        <section id="skills" class="max-w-6xl mx-auto px-6 py-16 md:py-24">
            <h2 class="text-3xl md:text-4xl font-bold text-white mb-12 text-center">
                Technical Expertise
            </h2>

            <div class="text-center mb-8">
                 <button id="toggle-skill-view" 
                    class="p-3 rounded-lg text-gray-300 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-opacity-50"
                    title="Toggle View">
                    <svg id="icon-list" xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                      <path stroke-linecap="round" stroke-linejoin="round" d="M4 6h16M4 10h16M4 14h16M4 18h16" />
                    </svg>
                    <svg id="icon-graph" xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 hidden" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                      <path stroke-linecap="round" stroke-linejoin="round" d="M13 10V3L4 14h7v7l9-11h-7z" /> 
                      <circle cx="6" cy="19" r="2" stroke-linecap="round" stroke-linejoin="round"/>
                      <circle cx="18" cy="5" r="2" stroke-linecap="round" stroke-linejoin="round"/>
                      <circle cx="6" cy="5" r="2" stroke-linecap="round" stroke-linejoin="round"/>
                      <path d="M14.5 10.5 L18 5"/>
                      <path d="M6 5 L 10 7"/>
                      <path d="M10 12 L 6 19"/>
                    </svg>
                </button>
                 <p id="view-label" class="text-xs text-gray-500 mt-1">Knowledge Graph View</p>
            </div>
            
            <div id="skill-graph-container" class="glass-card rounded-lg p-4 md:p-6 w-full overflow-hidden relative">
                <button id="fullscreen-toggle" class="absolute top-4 right-4 z-20 p-2 rounded-lg bg-gray-800 bg-opacity-50 text-gray-300 hover:bg-opacity-75 hover:text-white transition-all" title="Toggle Fullscreen">
                    <svg id="icon-expand" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                      <path stroke-linecap="round" stroke-linejoin="round" d="M3 8V6a2 2 0 012-2h14a2 2 0 012 2v12a2 2 0 01-2 2H5a2 2 0 01-2-2v-2" />
                    </svg>
                    <svg id="icon-minimize" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 hidden" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                      <path stroke-linecap="round" stroke-linejoin="round" d="M16 13V5a2 2 0 00-2-2H6a2 2 0 00-2 2v8a2 2 0 002 2h8a2 2 0 002-2zm-2 2v6a2 2 0 01-2 2H8a2 2 0 01-2-2v-6a2 2 0 012-2h6a2 2 0 012 2z" />
                    </svg>
                </button>
                <svg id="skill-graph"></svg>
            </div>

            <div id="skill-legend" class="flex flex-wrap justify-center gap-x-6 gap-y-3 mt-8 text-sm">
                </div>

            <div id="skill-grid-view" class="hidden grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                </div>
        </section>


        <section id="strategy" class="max-w-5xl mx-auto px-6 py-16 md:py-24">
            <h2 class="text-3xl md:text-4xl font-bold text-white mb-12 text-center">
                Strategic Initiatives
            </h2>
            
            <div class="flex justify-center border-b border-gray-700 mb-8 space-x-4 md:space-x-8" role="tablist">
                <button class="tab-button text-sm md:text-base font-medium py-3 px-2 md:px-4 border-b-2 active" data-tab-target="#tab-transition">
                    Transitioning to AI
                </button>
                <button class="tab-button text-sm md:text-base font-medium py-3 px-2 md:px-4 border-b-2 text-gray-400 border-transparent" data-tab-target="#tab-value">
                    Business Value
                </button>
                <button class="tab-button text-sm md:text-base font-medium py-3 px-2 md:px-4 border-b-2 text-gray-400 border-transparent" data-tab-target="#tab-collaboration">
                    Collaboration
                </button>
                <button class="tab-button text-sm md:text-base font-medium py-3 px-2 md:px-4 border-b-2 text-gray-400 border-transparent" data-tab-target="#tab-challenges">
                    Tackling Challenges
                </button>
            </div>

            <div class="mt-8 relative" style="transition: height 300ms ease-in-out;">
                
                <div id="tab-transition" role="tabpanel" class="space-y-8 absolute w-full">
                    <div class="glass-card p-6 md:p-8 rounded-lg">
                        <h3 class="text-2xl font-semibold text-white mb-4">1. Team Upskilling & Knowledge Transfer</h3>
                        <ul class="list-disc list-outside ml-5 space-y-3 text-gray-400">
                            <li>Lead by example, drawing on experience training engineers on LLMs (Claude, Flan-T5, etc.).</li>
                            <li>We will establish structured knowledge transfer (KT) sessions to build foundational skills in ML, NLU, and Generative AI, just as I did for my previous team.</li>
                            <li>Everyone should have a fair idea about every application in our team example: PRISM.</li>
                        </ul>
                    </div>
                    <div class="glass-card p-6 md:p-8 rounded-lg">
                        <h3 class="text-2xl font-semibold text-white mb-4">2. Targeted Technical Implementation</h3>
                        <ul class="list-disc list-outside ml-5 space-y-3 text-gray-400">
                            <li>Lead the design of scalable architectures, similar to the conditional architecture I designed for integrating Claude LLM with an internal chatbot at DBS Bank.</li>
                            <li>Build upon experience, such as the chatbot integrated into the Digibank app for customer support. An example of documented data transitioning into AI bot.</li>
                            <li>Focus on optimizing core products like Prism by reducing response time, thinking from a user's perspective (Product Mindset).</li>
                        </ul>
                    </div>
                </div>
                
                <div id="tab-value" role="tabpanel" class="hidden space-y-8 absolute w-full">
                    <div class="glass-card p-6 md:p-8 rounded-lg">
                        <h3 class="text-2xl font-semibold text-white mb-4">1. Immediate Cost Optimization</h3>
                        <p class="text-gray-400 mb-4">
                        Key areas of focus - Cost Optimization, Efficiency Gains, and Performance Enhancement. 
                       <a href="https://docs.google.com/spreadsheets/d/1104NYzT2YrAkthINzPqJesPxnEh7frx9GCGX1pqOYEo/edit?gid=0#gid=0" class="text-blue-400 hover:text-blue-300 underline">Link to future enhancements</a>
                       </p>
                        <ul class="list-disc list-outside ml-5 space-y-3 text-gray-400">
                            <li>Prioritize identifying high-cost computational processes.</li>
                            <li>Example: Migrated an intent training ML model from GPU to CPU to save company costs, demonstrating clear, immediate ROI.</li>
                            <li>Explore low-cost, high-efficiency models like Gemini-2.5-flash.</li>
                        </ul>
                    </div>
                    <div class="glass-card p-6 md:p-8 rounded-lg">
                        <h3 class="text-2xl font-semibold text-white mb-4">2. Automation & Efficiency</h3>
                        <ul class="list-disc list-outside ml-5 space-y-3 text-gray-400">
                            <li>Target high-effort, manual tasks for automation.</li>
                            <li>Example: Built automated Python scripts to analyze system accuracy, reducing manual testing efforts for stakeholders (similar to Prism testing script).</li>
                        </ul>
                    </div>
                    <div class="glass-card p-6 md:p-8 rounded-lg">
                        <h3 class="text-2xl font-semibold text-white mb-4">3. Core Product & Performance Enhancement</h3>
                        <ul class="list-disc list-outside ml-5 space-y-3 text-gray-400">
                            <li>Improve core user-facing systems, such as taking end-to-end ownership of an NLU neural network pipeline to improve multi-domain accuracy to 86%.</li>
                            <li>Improve sales questions by getting to the root problems of PRISM and building feasible, efficient solutions.</li>
                        </ul>
                    </div>
                </div>

                <div id="tab-collaboration" role="tabpanel" class="hidden space-y-8 absolute w-full">
                    <div class="glass-card p-6 md:p-8 rounded-lg">
                        <h3 class="text-2xl font-semibold text-white mb-4">1. Proactive Stakeholder Management</h3>
                        <ul class="list-disc list-outside ml-5 space-y-3 text-gray-400">
                            <li>I have experience managing stakeholders from different domains to enhance data quality for better LLM performance. I have worked with cross functional domains like - Treasury & Markets, HR, Group procurement and services, Legal compliance services, Investment banking & PE to collab and gather data for our internal chatbot.</li>
                        </ul>
                    </div>
                    <div class="glass-card p-6 md:p-8 rounded-lg">
                        <h3 class="text-2xl font-semibold text-white mb-4">2. Bringing in Data from stakeholders</h3>
                        <ul class="list-disc list-outside ml-5 space-y-3 text-gray-400">
                            <li>Actively present use cases to secure buy-in, as done when onboarding more business domains at DBS by demonstrating the value of enhanced conversational AI.</li>
                        </ul>
                    </div>
                    <div class="glass-card p-6 md:p-8 rounded-lg">
                        <h3 class="text-2xl font-semibold text-white mb-4">3. Release Management</h3>
                        <ul class="list-disc list-outside ml-5 space-y-3 text-gray-400">
                            <li>Collaborated with cross-functional teams to establish efficient release management workflows and meet the deadlines before code cut off windows.</li>
                        </ul>
                    </div>
                </div>

                <div id="tab-challenges" role="tabpanel" class="hidden space-y-8 absolute w-full">
                    <div class="glass-card p-6 md:p-8 rounded-lg">
                        <h3 class="text-2xl font-semibold text-white mb-4">1. Challenge: Team Upskilling & Adopting New Tech</h3>
                        <ul class="list-disc list-outside ml-5 space-y-3 text-gray-400">
                            <li>Experience training junior engineers and interns on LLMs (Claude, Flan-T5, etc.) and providing structured KT sessions.</li>
                            <li>Worked with graph database technologies (Neo4j, Cypher), the foundation of KGs, and can train the team on their practical application with brainstorming sessions.</li>
                        </ul>
                    </div>
                    <div class="glass-card p-6 md:p-8 rounded-lg">
                        <h3 class="text-2xl font-semibold text-white mb-4">2. Challenge: Release Management</h3>
                        <ul class="list-disc list-outside ml-5 space-y-3 text-gray-400">
                            <li>Adopt a Clear Branching Strategy: Use a standardized model where new work starts on its own feature branch (e.g., `feature/BIMI-123`).</li>
                            <li>This provides perfect traceability from a JIRA ticket to the code in Gitlab.</li>
                            <li>Changes are only merged into dev after a pull request and successful code review, isolating new work and keeping the main branch stable.</li>
                            <li>Maintaining confluence for all the documentation, example: Application documentation</li>
                        </ul>
                    </div>
                </div>

            </div>
        </section>

        <footer class="mt-24 pb-12 text-center text-red-1000 text-sm">
            Thank you üë®‚Äçüíª.
        </footer>

    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            
            // --- 1. JAVASCRIPT FOR TABS ---
            const tabs = document.querySelectorAll('[data-tab-target]');
            const tabContents = document.querySelectorAll('[role="tabpanel"]');
            const tabContainer = document.querySelector('.mt-8.relative');

            let currentTab = tabContents[0];
            let currentTabHeight = currentTab ? currentTab.offsetHeight : 0; // Check if currentTab exists
            if (tabContainer) tabContainer.style.height = `${currentTabHeight}px`; // Check if tabContainer exists

            tabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    const targetSelector = tab.dataset.tabTarget;
                    const target = document.querySelector(targetSelector);
                    if (!target || target === currentTab) return;

                    // Deactivate all tabs
                    tabs.forEach(t => {
                        t.classList.remove('active', 'text-blue-500', 'border-blue-500');
                        t.classList.add('text-gray-400', 'border-transparent');
                    });
                    
                    // Activate clicked tab
                    tab.classList.add('active', 'text-blue-500', 'border-blue-500');
                    tab.classList.remove('text-gray-400', 'border-transparent');

                    // --- Tab Transition Logic ---
                    // Make the new tab visible but transparent and out of the way
                    target.classList.remove('hidden');
                    
                    // Get height first
                    const newHeight = target.offsetHeight;

                    // Fade out the current tab
                    currentTab.classList.add('opacity-0');
                    
                    // After a short delay, hide the old tab and show the new one
                    setTimeout(() => {
                        currentTab.classList.add('hidden');
                        
                        // Set the container height to the new tab's height
                        tabContainer.style.height = `${newHeight}px`;

                        // Fade in the new tab
                        target.classList.remove('opacity-0');
                        
                        // Update the current tab
                        currentTab = target;
                    }, 300); // Match this to CSS transition duration
                });
            });

            // Initialize the first tab
            if (tabs.length > 0) {
                tabs[0].classList.add('active', 'text-blue-500', 'border-blue-500');
                tabs[0].classList.remove('text-gray-400', 'border-transparent');
                tabContents[0].classList.remove('hidden', 'opacity-0');
            }
            
            // Adjust container height on window resize
            window.addEventListener('resize', () => {
                if (currentTab) {
                    // Use rAF to ensure we get the height *after* potential layout shifts
                    requestAnimationFrame(() => {
                        const newHeight = currentTab.offsetHeight;
                        if (tabContainer) tabContainer.style.height = `${newHeight}px`; // Check tabContainer
                    });
                }
            });


            // --- 2. JAVASCRIPT FOR KNOWLEDGE GRAPH ---
            
            // --- Updated skillData object ---
            const skillData = {
                name: "Technical Expertise",
                children: [
                    { 
                        name: "Applied AI & ML", 
                        children: [
                            "LLM‚Äôs", "SLM‚Äôs", "Transformer", "BERT", "Neural Networks", "Regression", 
                            "RAG", "Prompt Engineering", "Chunking", "Langchain", "Langgraph", "NLP", "NLU", 
                            "SOTA Models", "Agentic AI"
                        ]
                    },
                    {
                        name: "Applied AI Infra", 
                        children: [
                            "AWS Bedrock", "CUDA", "Observability", "Grounding"
                        ]
                    },
                    { 
                        name: "Databases (Vector/Graph)", 
                        children: [
                            "NEO4J", "Elastic Search", "Cypher Query", "Chroma DB", "Pinecone"
                        ]
                    },
                    { 
                        name: "Full Stack", 
                        children: ["Angular JS", "CSS", "HTML5", "Jboss", "Linux"]
                    },
                    { 
                        name: "Languages & Frameworks", 
                        children: ["Python", "Pandas", "Numpy", "Java 8", "Javascript", "Flask", "Django", "Go (Basics)"]
                    },
                    { 
                        name: "Databases (SQL/NoSQL)", 
                        children: ["MongoDB", "SQL", "ES", "Dynamodb"]
                    },
                    { 
                        name: "Management & Design", 
                        children: ["Tech Management", "Release Management", "ARD/PRD", "LLD / HLD", "Figma", "App Sec"]
                    },
                    { 
                        name: "Cloud Infra", 
                        children: ["AWS", "GCP"]
                    }
                ]
            };
            
            // Select the SVG and container
            const svg = d3.select("#skill-graph");
            const container = document.getElementById("skill-graph-container");
            let simulation; // Make simulation accessible to redraw
            let link, node, text; // Make graph elements globally accessible within this scope
            let allNodes = [];
            let allLinks = [];
            let zoom; // Make zoom accessible
            let width, height; // Make dimensions global

            // Fullscreen Elements
            const fullscreenButton = document.getElementById('fullscreen-toggle'); // Renamed for clarity
            const iconExpand = document.getElementById('icon-expand');
            const iconMinimize = document.getElementById('icon-minimize');

            if (fullscreenButton) { // Check if button exists on this page
                fullscreenButton.addEventListener('click', () => {
                    const isFullscreen = container.classList.toggle('fullscreen');
                    
                    // Toggle icons
                    iconExpand.classList.toggle('hidden', isFullscreen);
                    iconMinimize.classList.toggle('hidden', !isFullscreen);
                    
                    // Redraw graph to fit new dimensions
                    setTimeout(drawGraph, 50); 
                });
            }


            // Function to draw the graph
            function drawGraph() {
                if (!container) return; // Don't run if graph container isn't on the page

                // Clear previous graph
                svg.selectAll("*").remove();

                width = container.clientWidth;
                height = container.clientHeight;

                svg.attr("viewBox", [-width / 2, -height / 2, width, height]);

                // --- Zoom & Pan Setup ---
                const g = svg.append("g").attr("class", "graph-content");

                const zoomed = (event) => {
                    g.attr("transform", event.transform);
                };

                zoom = d3.zoom()
                    .scaleExtent([0.1, 8]) 
                    .on("zoom", zoomed);
                
                // Apply zoom behavior
                svg.call(zoom);

                // --- Data Processing ---
                const nodes = [];
                const links = [];
                const categories = [];
                
                const mainNode = { id: skillData.name, group: 0, level: 0, fx: 0, fy: 0 }; 
                nodes.push(mainNode);

                let groupIndex = 1;
                skillData.children.forEach(category => {
                    const catNode = { id: category.name, group: groupIndex, level: 1 };
                    nodes.push(catNode);
                    links.push({ source: mainNode.id, target: category.name });
                    categories.push({ name: category.name, group: groupIndex });

                    category.children.forEach(skill => {
                        let skillNode = nodes.find(n => n.id === skill);
                        if (!skillNode) {
                            skillNode = { id: skill, group: groupIndex, level: 2 }; 
                            nodes.push(skillNode);
                        }
                        links.push({ source: category.name, target: skill });
                    });
                    groupIndex++;
                });

                allNodes = nodes; // Save for interactions
                allLinks = links; // Save for interactions

                // --- Color Scale ---
                const color = d3.scaleOrdinal(d3.schemeTableau10);

                // --- Force Simulation (OVERLAP FIX) ---
                simulation = d3.forceSimulation(nodes)
                    .force("link", d3.forceLink(links).id(d => d.id).distance(d => d.source.level === 0 ? 180 : 80))
                    // Increased repulsion for level 2 (skill) nodes
                    .force("charge", d3.forceManyBody().strength(d => d.level === 0 ? -1500 : (d.level === 1 ? -400 : -150))) 
                    .force("center", d3.forceCenter(0, 0))
                    // Increased collision radius for level 2 (skill) nodes
                    .force("collide", d3.forceCollide().radius(d => d.level === 2 ? 25 : 30)); 

                // --- Draw Links ---
                link = g.append("g") 
                    .attr("class", "skill-graph-links")
                    .selectAll("line")
                    .data(links)
                    .join("line");

                // --- Draw Nodes ---
                node = g.append("g")
                    .attr("class", "skill-graph-nodes")
                    .selectAll("circle")
                    .data(nodes)
                    .join("circle")
                    .attr("r", d => d.level === 0 ? 18 : (d.level === 1 ? 12 : 7))
                    .attr("fill", d => color(d.group))
                    // Add class for pulsing
                    .attr("class", d => d.level === 0 ? "level-0-node" : null)
                    .call(drag(simulation)); 

                // --- Draw Labels ---
                text = g.append("g")
                    .attr("class", "skill-graph-labels")
                    .selectAll("text")
                    .data(nodes)
                    .join("text")
                    .text(d => d.id)
                    .attr("class", d => `level-${d.level}`) 
                    .attr("dx", d => d.level === 0 ? 0 : (d.level === 1 ? 16 : 10))
                    .attr("dy", ".35em")
                    .attr("text-anchor", d => d.level === 0 ? "middle" : "start");

                // --- NEW: Instant Hover-to-Highlight Logic (NO STUTTER) ---
                
                function unhighlight() {
                    node.style('opacity', 1)
                        .attr("r", d => d.level === 0 ? 18 : (d.level === 1 ? 12 : 7)); // Reset radius

                    text.style('opacity', 1)
                        .style("font-size", d => d.level === 0 ? "16px" : (d.level === 1 ? "12px" : "10px")) // Reset font size
                        .attr("dx", d => d.level === 0 ? 0 : (d.level === 1 ? 16 : 10)); // Reset position
                    
                    link.style('stroke-opacity', 0.4).style('stroke-width', null);
                }

                function highlight(d) {
                    if (!d) return unhighlight();

                    const connectedNodes = new Set();
                    const group = d.group;

                    // Add all nodes from the same group
                    allNodes.forEach(n => {
                        if (n.group === group) connectedNodes.add(n.id);
                    });
                    
                    // Always add the root node
                    connectedNodes.add(allNodes[0].id); // Root is always first
                    
                    // If root is hovered, add all categories
                    if (d.group === 0) {
                        allNodes.forEach(n => {
                            if (n.level === 1) connectedNodes.add(n.id);
                        });
                    }

                    // --- Instantaneous changes ---
                    node.style('opacity', n => connectedNodes.has(n.id) ? 1 : 0.1)
                        .attr("r", n => connectedNodes.has(n.id) ? 
                            (n.level === 0 ? 22 : (n.level === 1 ? 15 : 9)) : // Enlarged radius
                            (n.level === 0 ? 18 : (n.level === 1 ? 12 : 7))  // Default radius
                        ); 
                    
                    text.style('opacity', t => connectedNodes.has(t.id) ? 1 : 0.1)
                        .style("font-size", t => connectedNodes.has(t.id) ?
                            (t.level === 0 ? "20px" : (t.level === 1 ? "15px" : "12px")) : // Enlarged font
                            (t.level === 0 ? "16px" : (t.level === 1 ? "12px" : "10px")) // Default font
                        )
                        .attr("dx", t => connectedNodes.has(t.id) ?
                            (t.level === 0 ? 0 : (t.level === 1 ? 19 : 12)) : // Pushed out position
                            (t.level === 0 ? 0 : (t.level === 1 ? 16 : 10)) // Default position
                        );
                    
                    link.style('stroke-opacity', l => (connectedNodes.has(l.source.id) && connectedNodes.has(l.target.id)) ? 0.7 : 0.05)
                        .style('stroke-width', l => (connectedNodes.has(l.source.id) && connectedNodes.has(l.target.id)) ? '2.5px' : '1px');
                }

                // Apply hover events
                node.on('mouseover.highlight', (event, d) => highlight(d));
                node.on('mouseout.highlight', () => unhighlight());
                
                // REMOVED click-to-zoom logic
                // --- End of new interaction logic ---

                // --- Simulation Tick ---
                simulation.on("tick", () => {
                    link
                        .attr("x1", d => d.source.x)
                        .attr("y1", d => d.source.y)
                        .attr("x2", d => d.target.x)
                        .attr("y2", d => d.target.y);
                    node
                        .attr("cx", d => d.x)
                        .attr("cy", d => d.y);
                    text
                        .attr("x", d => d.x)
                        .attr("y", d => d.y);
                });

                // --- Drag Functions ---
                function drag(simulation) {
                    function dragstarted(event, d) {
                        event.sourceEvent.stopPropagation(); 
                        if (!event.active) simulation.alphaTarget(0.3).restart();
                        d.fx = d.x;
                        d.fy = d.y;
                    }
                    function dragged(event, d) {
                        d.fx = event.x;
                        d.fy = event.y;
                    }
                    function dragended(event, d) {
                        if (!event.active) simulation.alphaTarget(0);
                        if (d.level !== 0) { 
                            d.fx = null;
                            d.fy = null;
                        }
                    }
                    return d3.drag()
                        .on("start", dragstarted)
                        .on("drag", dragged)
                        .on("end", dragended);
                }

                // --- Build Legend ---
                const legendContainer = d3.select("#skill-legend");
                if (legendContainer.node()) { // Check if legend container exists
                    legendContainer.selectAll("*").remove(); 

                    const legend = legendContainer.selectAll(".legend-item")
                        .data(categories)
                        .join("div")
                        .attr("class", "legend-item flex items-center");
                    
                    legend.append("div")
                        .style("width", "12px")
                        .style("height", "12px")
                        .style("background-color", d => color(d.group))
                        .attr("class", "rounded-full mr-2");

                    legend.append("span")
                        .text(d => d.name)
                        .attr("class", "text-gray-400");
                }
            }

            // Initial draw
            drawGraph();

            // Redraw on resize
            let resizeTimer;
            window.addEventListener('resize', () => {
                // Only redraw if not in fullscreen (fullscreen has its own redraw)
                if (container && !container.classList.contains('fullscreen')) { // Check container
                    clearTimeout(resizeTimer);
                    resizeTimer = setTimeout(drawGraph, 200); 
                }
            });

            // --- 3. JAVASCRIPT FOR SKILL VIEW TOGGLE ---
            const toggleBtn = document.getElementById('toggle-skill-view');
            const graphView = document.getElementById('skill-graph-container');
            const legendView = document.getElementById('skill-legend');
            const gridView = document.getElementById('skill-grid-view');
            const iconList = document.getElementById('icon-list'); // Get icon refs
            const iconGraph = document.getElementById('icon-graph');
            const viewLabel = document.getElementById('view-label'); // Get label ref
            
            // --- Manually create list view from skillData ---
            const gridContainer = document.getElementById("skill-grid-view");
            if (gridContainer) { // Check if grid container exists
                gridContainer.innerHTML = ""; // Clear any static content
                
                const color = d3.scaleOrdinal(d3.schemeTableau10);
                let groupIndex = 1;
                
                skillData.children.forEach(category => {
                    const card = document.createElement("div");
                     // Back to multiple columns for list view
                    card.className = "glass-card p-6 rounded-lg";
                    
                    const title = document.createElement("h3");
                    title.className = "text-xl font-semibold text-white mb-4";
                    title.textContent = category.name;
                    title.style.color = color(groupIndex); // Match graph color
                    
                    const list = document.createElement("ul");
                    list.className = "list-disc list-outside ml-5 space-y-2 text-gray-400 text-sm";
                    
                    category.children.forEach(skill => {
                        const item = document.createElement("li");
                        item.textContent = skill;
                        list.appendChild(item);
                    });
                    
                    card.appendChild(title);
                    card.appendChild(list);
                    gridContainer.appendChild(card);
                    
                    groupIndex++;
                });
            }
            // --- End of dynamic list view creation ---
            
            // --- Toggle Button Click Listener ---
            if (toggleBtn) { // Check if toggle button exists
                toggleBtn.addEventListener('click', () => {
                    const isGraphVisible = !graphView.classList.contains('hidden');
                    
                    // Toggle visibility
                    graphView.classList.toggle('hidden');
                    legendView.classList.toggle('hidden');
                    gridView.classList.toggle('hidden');

                    // Toggle icons
                    iconList.classList.toggle('hidden', !isGraphVisible); // Show List icon when switching TO list
                    iconGraph.classList.toggle('hidden', isGraphVisible); // Show Graph icon when switching TO graph

                     // Update title for accessibility and label text
                    if (isGraphVisible) {
                        toggleBtn.title = "Show Graph View";
                        viewLabel.textContent = "List View"; // Update label
                    } else {
                        toggleBtn.title = "Show List View";
                        viewLabel.textContent = "Knowledge Graph View"; // Update label
                    }
                });
            }
            

            // --- 4. JAVASCRIPT FOR BACKGROUND CANVAS (Waves & Stars) ---
            const canvas = document.getElementById('background-canvas'); // Use the correct ID
            const ctx = canvas.getContext('2d');
            let time = 0;
            let stars = []; // Array to hold star particles

            // --- Star Particle generation (ADJUSTED & ADDED SPEED) ---
            const numStars = 150; // Increased count
            function initStars() {
                stars = []; // Clear existing stars
                for (let i = 0; i < numStars; i++) {
                    stars.push({
                        x: Math.random() * canvas.width,
                        y: Math.random() * canvas.height,
                        radius: Math.random() * 1.5 + 0.5, // Star size
                        baseAlpha: Math.random() * 0.5 + 0.5, // Increased base brightness (0.5 to 1.0)
                        alpha: Math.random(), // Current brightness
                        twinkleSpeed: Math.random() * 0.02 + 0.005, // How fast it twinkles
                        xSpeed: (Math.random() - 0.5) * 0.1, // Added horizontal speed (slow drift)
                        ySpeed: Math.random() * 0.2 + 0.1 // Falling speed
                    });
                }
            }

            function resizeCanvas() {
                canvas.width = window.innerWidth;
                canvas.height = window.innerHeight;
                initStars(); // Recreate stars on resize
            }

            function drawSineWave(frequency, amplitude, speed, color, opacity, lineWidth) {
                ctx.beginPath();
                ctx.moveTo(0, canvas.height / 2);
                ctx.strokeStyle = color;
                ctx.globalAlpha = opacity;
                ctx.lineWidth = lineWidth;

                for (let x = 0; x < canvas.width; x++) {
                    const y = Math.sin(x * frequency + time * speed) * amplitude + canvas.height / 2;
                    ctx.lineTo(x, y);
                }
                ctx.stroke();
            }

            function drawStars() {
                // Ensure globalAlpha is reset before drawing stars
                 ctx.globalAlpha = 1.0; 
                stars.forEach(star => {
                    // Update twinkle
                    star.alpha = star.baseAlpha * (Math.sin(time * star.twinkleSpeed) * 0.5 + 0.5); // Oscillate opacity

                    // Update position (falling effect - NOW DIAGONAL)
                    star.x += star.xSpeed; 
                    star.y += star.ySpeed;
                    
                    // Reset star if it falls off screen (wrap around)
                    if (star.y > canvas.height + star.radius) { 
                        star.y = -star.radius;
                        star.x = Math.random() * canvas.width;
                    } else if (star.y < -star.radius) { // Handle moving up? Unlikely with current speeds
                         star.y = canvas.height + star.radius;
                         star.x = Math.random() * canvas.width;
                    }
                     if (star.x > canvas.width + star.radius) { 
                        star.x = -star.radius;
                         star.y = Math.random() * canvas.height; // Reset y too for better distribution
                    } else if (star.x < -star.radius) {
                        star.x = canvas.width + star.radius;
                         star.y = Math.random() * canvas.height;
                    }


                    // Draw star
                    ctx.beginPath();
                    ctx.arc(star.x, star.y, star.radius, 0, Math.PI * 2);
                    ctx.fillStyle = `rgba(255, 255, 255, ${star.alpha})`;
                    ctx.fill();
                });
            }

            function animate() {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                
                // Draw waves first (opacity increased)
                // Wave 1: Main blue wave
                drawSineWave(0.003, 100, 0.01, '#3b82f6', 0.35, 2); // Increased opacity from 0.2
                // Wave 2: Softer purple wave
                drawSineWave(0.002, 120, 0.005, '#8b5cf6', 0.2, 2); // Increased opacity from 0.1
                // Wave 3: Subtle white highlight wave
                drawSineWave(0.004, 80, 0.015, '#ffffff', 0.15, 1); // Increased opacity from 0.1
                // Wave 4: Slow, deep wave
                drawSineWave(0.001, 150, 0.002, '#4f46e5', 0.1, 3); // Increased opacity from 0.05

                // Draw stars on top
                drawStars(); 

                ctx.globalAlpha = 1.0; // Reset alpha for next frame
                time++;
                requestAnimationFrame(animate);
            }

            window.addEventListener('resize', resizeCanvas);
            resizeCanvas(); // Initial call includes initStars()
            animate();
        });
    </script>
</body>
</html>
